# 双人减肥打卡记录 · 软件使用说明书

---

## 一、产品简介

**双人减肥打卡记录**是一款面向两人互相监督的减肥打卡应用。两人通过邀请码绑定后，可每日记录体重、运动、饮食等情况，并对对方的打卡进行评分与鼓励，在「动态」页查看双方对比与趋势，帮助坚持养成习惯。

**主要特点：**

- 无需注册账号，输入昵称即可使用（匿名登录）
- 通过**邀请码**即可与好友绑定，支持异地使用
- 每日打卡可填：体重、体脂、运动、早午晚饮食、饮水、睡眠、心情（均为选填）
- 可为对方的打卡打 1～5 星（完成度、努力度）并写评语
- 支持「今日打卡当日即可评分」与「次日评分」两种方式
- 消息实时提醒：伙伴已打卡、伙伴已更新打卡、TA 提醒你评分等
- 动态页提供「我的记录」与「双方对比」，含打卡日历、本周 PK、评分趋势等

**访问方式：** 浏览器打开 https://doublecheckin.vercel.app（或部署后的网址），建议使用手机浏览器或电脑浏览器，界面为移动端适配。

---

## 二、首次使用：登录

1. 打开应用，进入**登录页**。
2. 输入你的**昵称**（如「彭雨」），点击进入。
3. 系统会为你分配一个**邀请码**（在「我的」→「邀请伙伴」中可查看），用于与伙伴绑定。

无需手机号、邮箱或密码；同一设备再次打开会保持登录状态。

---

## 三、首页：今日打卡

**入口：** 底部导航 **「首页」**。

**功能说明：**

- 顶部显示当前日期与你和伙伴的昵称（若已绑定）。
- 若尚未绑定伙伴，会显示**「邀请伙伴一起打卡」**卡片，点击**「去绑定」**可前往绑定流程。
- 表单可填写（均为选填）：
  - **体重(kg)**、**体脂率(%)**
  - **运动类型**（跑步/游泳/力量/瑜伽/骑行/其他）、**运动时长(分钟)**
  - **早餐 / 午餐 / 晚餐**（简单描述）
  - **饮水量**（杯数 + 可选 ml）
  - **睡眠(小时)**、**心情/备注**
- 点击**「提交打卡」**保存当日数据；当日可多次修改并再次提交。
- 提交后按钮变为**「已打卡（可修改后再次提交）」**，再次点击即更新当日打卡。

**规则：** 仅支持对**当天**进行打卡或修改，不能补录或修改往日的打卡。

---

## 四、邀请与绑定伙伴

### 4.1 邀请方（发邀请码的人）

1. 进入**「我的」**，点击**「邀请伙伴」**（或根据引导进入**「加入伙伴」**页后选择「我有邀请码」）。
2. 页面会显示**您的邀请码**（如 `CXSXMX`）。
3. 将邀请码通过微信、短信等方式发给对方。
4. 对方在 App 内输入该邀请码并完成绑定后，**双方会自动建立双向绑定**，你会在「消息」中收到「xxx 已与你建立伙伴关系」的通知。

### 4.2 加入方（输入邀请码的人）

1. 进入**「我的」** → **「加入伙伴」**（或从首页未绑定时的「去绑定」进入）。
2. 在**「邀请码」**输入框中粘贴或输入对方发给你的**邀请码**（不区分大小写）。
3. 点击**「确认绑定」**。
4. 绑定成功后，双方在首页、动态、消息等页都能看到对方，并可互看打卡与评分。

**说明：** 每人只能绑定一位伙伴；若需更换伙伴，需先在「我的」中**解绑**后再绑定新伙伴。

---

## 五、消息

**入口：** 底部导航 **「消息」**。

消息页包含三块内容（自上而下）：

### 5.1 提醒伙伴评分（手动）

- 当**伙伴还未给你的今日或昨日打卡评分**时，会显示**「提醒伙伴评分」**卡片。
- 点击**「提醒 TA 评分」**，对方会在消息中收到一条提醒（如「可立即在消息页为 TA 的今日打卡评分哦」）。
- 若今日、昨日都未评，会优先提醒「今日」；若今日已评则提醒「昨日」（在评分有效期内）。

### 5.2 待评分 · 伙伴今日/昨日打卡

- 当**对方有今日或昨日打卡**时，页面顶部会出现评分卡片：
  - **今日**：若你尚未评分，标题为**「待评分 · 伙伴今日打卡」**；若你已评过分（包括伙伴之后又更新了打卡），标题为**「修改今日评分 · 伙伴今日打卡」**，表单会预填你之前的评分，可改星数与评语后点击**「更新评分」**，以当天 24 点前最后一次为准。
  - **昨日**：仅当你尚未评分且在次日有效期内时显示**「待评分 · 伙伴昨日打卡」**。
- 卡片中会展示对方该次打卡的**日期**及**详细内容**（体重、体脂、运动、早午晚、饮水、睡眠、心情）；已填写项为黄色底纹，未填写项显示「对方没有填写」并带红色底纹。
- 你可对**完成度**、**努力度**各打 1～5 星，并可填写一句**鼓励或建议**（选填），点击**「提交评分」**或**「更新评分」**（修改今日时）即可。
- **评分规则：**
  - **今日打卡**：对方当天提交后，你**当天**即可在消息页为 TA 的今日打卡评分；若你已评过分但对方又更新了打卡，消息页会显示**「修改今日评分」**，可修改星数与评语并点击**「更新评分」**，**以当天 24 点前最后一次评分为准**。
  - **昨日打卡**：仅能在**次日**当天内评分，过期后该条打卡不能再评。

### 5.3 系统通知

- 展示所有系统消息，例如：
  - **伙伴已打卡**：对方首次提交今日打卡时，你会收到「可立即在消息页为 TA 的今日打卡评分」及当日打卡摘要。
  - **伙伴已更新今日打卡**：对方修改了今日打卡内容且与上次有变化时，你会收到更新提示及最新摘要。
  - **TA 提醒你评分**：对方点击「提醒 TA 评分」时，你会收到提醒。
  - **xxx 已与你建立伙伴关系**：对方通过你的邀请码完成绑定时，你会收到通知。
- 新消息会通过实时推送显示（需网络正常）；点击某条消息可标记为已读。

### 5.4 历史评分

- 列出你**已给出的**评分记录（日期、完成度与努力度星数、评语），方便回顾。

---

## 六、动态（我的记录与双方对比）

**入口：** 底部导航 **「动态」**。

页面上方有两个 Tab：**「我的记录」**、**「双方对比」**。

### 6.1 我的记录

- **打卡日历：** 以月为单位展示日历，已打卡日期会高亮显示；点击某日可查看该日打卡详情（体重、运动、饮水、睡眠、心情等）。
- 可通过**「上月」「下月」**切换月份。
- **本月打卡**：显示当月打卡天数。
- **累计减重**：根据你的打卡记录计算体重变化（最早与最近一次体重之差）。

### 6.2 双方对比（需已绑定伙伴）

- **头部：** 左右并排显示你与伙伴的头像、昵称；中间为**本周打卡次数对比**（柱状图），下方为一句**鼓励语**（如「你已领先 X 天，继续加油！」「伙伴本周还没打卡，快去提醒 TA」等）。本周按周一至周日计算。
- **核心指标卡片（左右并列）：**
  - **我的数据**：当前体重、本周体重变化、本周打卡进度（X/7 天）、收到的评分均分（完成度、努力度）。
  - **伙伴数据**：同上，展示伙伴的体重、本周打卡与收到均分。
- **评分趋势（近 7 天）：** 以柱状图形式展示近 7 天你与伙伴各自「收到的评分」均值，便于对比。
- **TA 给你的最新评价：** 若有伙伴给你的评分且带评语，会展示最近一条的日期、星数与评语。
- **查看历史对比：** 点击**「查看历史对比（打卡日历与累计数据）」**可跳转到「我的记录」Tab，查看打卡日历与累计数据。

若未绑定伙伴，双方对比区域会提示「暂无伙伴，绑定伙伴后即可在这里查看双方对比」。

---

## 七、我的（个人中心）

**入口：** 底部导航 **「我的」**。

- **个人信息**：展示昵称、头像（若有）、邀请码等。
- **邀请伙伴**：查看并复制你的邀请码，发给对方以便其「加入伙伴」。
- **加入伙伴**：输入对方的邀请码并确认绑定。
- **评分趋势**：查看你收到的评分趋势（入口到动态/消息等，依实际界面为准）。
- **成就**：可进入成就墙查看已解锁的成就（若有）。
- **解绑伙伴**：解除与当前伙伴的绑定关系；解绑后双方都无法再看到对方的打卡与评分，需重新绑定才能恢复。解绑为双向生效。

---

## 八、评分与消息规则小结

| 场景             | 说明                                                                 |
|------------------|----------------------------------------------------------------------|
| 今日首次打卡     | 伙伴会收到「伙伴已打卡」+ 当日摘要，可立即在消息页为今日打卡评分。   |
| 今日修改打卡     | 仅当内容有变化时，伙伴会收到「伙伴已更新今日打卡」+ 最新摘要。       |
| 今日评分可修改   | 伙伴已评过今日打卡后，若对方又更新了打卡，可在消息页「修改今日评分」中更新评分，以 24 点前最后一次为准。 |
| 今日未修改再提交 | 不会重复发消息。                                                     |
| 昨日打卡         | 伙伴可在**次日**当天内，在消息页「待评分」中为昨日打卡评分。         |
| 提醒对方评分     | 你可在消息页点击「提醒 TA 评分」，对方会收到一条提醒消息。           |

---

## 九、常见问题

**Q：忘记邀请码怎么办？**  
在「我的」页可查看当前账号的邀请码；若未显示，可进入「邀请伙伴」查看。

**Q：对方输入邀请码提示「邀请码不存在或无效」？**  
请确认：(1) 邀请码未输错、未多空格；(2) 已在 Supabase 中执行「允许按邀请码查询 profiles」的 SQL（见项目部署文档）；(3) 网络正常。

**Q：为什么我刷新后系统消息会多一条？**  
若已更新到最新版本，仅在**今日首次打卡**或**今日修改且内容有变化**时才会给伙伴发一条消息；重复提交且内容未改不会多发。若仍出现多条，可能是旧版本或历史数据导致。

**Q：可以补录昨天的打卡吗？**  
不可以。当前仅支持对**当天**进行打卡或修改。

**Q：解绑后数据会丢吗？**  
解绑只解除两人之间的绑定关系；各自的打卡、评分等历史数据仍保留在本人的账号下，但双方无法再查看对方的数据。重新绑定后，只能看到绑定之后的新数据。

**Q：在国内打不开链接？**  
若部署在海外（如 Vercel），国内访问可能需要使用 VPN。

**Q：能否多人一起打卡？**  
当前仅支持**两人**互相绑定与对比；每人只能绑定一位伙伴。

---

## 十、界面与导航小结

- **底部四栏**：首页 | 动态 | 消息 | 我的。
- **首页**：今日打卡表单、邀请伙伴入口（未绑定时）。
- **动态**：我的记录（打卡日历、本月统计、累计减重）、双方对比（本周 PK、核心指标、评分趋势、最新互评）。
- **消息**：提醒伙伴评分、待评分卡片、系统通知、历史评分。
- **我的**：邀请码、加入伙伴、成就、解绑等。

以上为当前版本的功能与使用说明，若有界面调整以实际应用为准。  
如有问题，可结合项目中的 README、DEPLOY 文档或 Supabase 配置说明一起查阅。
